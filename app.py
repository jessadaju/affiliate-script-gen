import streamlit as st
import google.generativeai as genai

# --- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö ---
st.set_page_config(page_title="Affiliate Script Gen (SaaS)", page_icon="üé¨")

# --- ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API (‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏ã‡πà‡∏≠‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏•‡∏±‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÑ‡∏î‡πâ) ---
with st.sidebar:
    st.header("‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö")
    api_key = st.text_input("‡πÉ‡∏™‡πà Gemini API Key ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì", type="password")
    st.info("‡πÑ‡∏õ‡∏Ç‡∏≠ Key ‡∏ü‡∏£‡∏µ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà: aistudio.google.com")
    
# --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å AI ---
def generate_script(product_name, features, tone):
    # Prompt ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÑ‡∏ß‡πâ (System Prompt)
    prompt = f"""
    ‡∏™‡∏ß‡∏°‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÄ‡∏õ‡πá‡∏ô Creative Director ‡∏°‡∏∑‡∏≠‡∏ó‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö TikTok/Reels
    
    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: {product_name}
    ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô: {features}
    ‡πÇ‡∏ó‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ: {tone}
    
    ‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:
    1. ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á 30-45 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô 4 ‡∏â‡∏≤‡∏Å (Hook, Problem, Solution, CTA)
    2. ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô "Visual Prompt" (‡∏ö‡∏£‡∏µ‡∏ü‡∏†‡∏≤‡∏û‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏â‡∏≤‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡∏™‡∏±‡πà‡∏á AI ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏ï‡πà‡∏≠
    
    ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö (‡∏Ç‡∏≠‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πä‡∏∞‡πÜ):
    ### ‡∏â‡∏≤‡∏Å‡∏ó‡∏µ‡πà 1: [‡∏ä‡∏∑‡πà‡∏≠‡∏â‡∏≤‡∏Å]
    **üó£Ô∏è ‡∏ö‡∏ó‡∏û‡∏π‡∏î:** [‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°]
    **üé¨ ‡∏ö‡∏£‡∏µ‡∏ü‡∏†‡∏≤‡∏û:** [‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏†‡∏≤‡∏û ‡πÅ‡∏™‡∏á ‡∏°‡∏∏‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á]
    
    (‡∏ó‡∏≥‡∏ã‡πâ‡∏≥‡∏à‡∏ô‡∏Ñ‡∏£‡∏ö 4 ‡∏â‡∏≤‡∏Å)
    """
    
    try:
        genai.configure(api_key=api_key)
        model = genai.GenerativeModel('gemini-pro') # ‡πÉ‡∏ä‡πâ‡∏£‡∏∏‡πà‡∏ô‡∏ü‡∏£‡∏µ
        response = model.generate_content(prompt)
        return response.text
    except Exception as e:
        return f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {e}"

# --- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å (UI) ---
st.title("üé¨ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏¥‡∏î‡∏Ñ‡∏•‡∏¥‡∏õ Affiliate (SaaS Demo)")
st.subheader("‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå + ‡∏ö‡∏£‡∏µ‡∏ü‡∏†‡∏≤‡∏û ‡πÉ‡∏ô 1 ‡∏Ñ‡∏•‡∏¥‡∏Å")

# Form ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
with st.form("script_form"):
    col1, col2 = st.columns(2)
    with col1:
        product_name = st.text_input("‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?", placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏Å‡πâ‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏¢‡πá‡∏ô 30oz")
    with col2:
        tone_select = st.selectbox("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ñ‡∏•‡∏¥‡∏õ", ["‡∏ï‡∏•‡∏Å ‡πÄ‡∏Æ‡∏Æ‡∏≤", "‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç", "‡∏î‡∏£‡∏≤‡∏°‡πà‡∏≤ ‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á", "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏™‡∏≤‡∏ß‡πÄ‡∏°‡πâ‡∏≤‡∏ó‡πå‡∏°‡∏≠‡∏¢"])
    
    features = st.text_area("‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (3-4 ‡∏Ç‡πâ‡∏≠)", placeholder="- ‡πÄ‡∏Å‡πá‡∏ö‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡∏Ç‡πâ‡∏≤‡∏°‡∏ß‡∏±‡∏ô\n- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏≠‡∏ô‡πâ‡∏≥‡πÄ‡∏Å‡∏≤‡∏∞\n- ‡πÅ‡∏ñ‡∏°‡∏´‡∏•‡∏≠‡∏î‡πÄ‡∏´‡∏•‡πá‡∏Å")
    
    submitted = st.form_submit_button("üöÄ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏ô‡∏µ‡πâ")

# ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
if submitted:
    if not api_key:
        st.error("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà API Key ‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö")
    elif not product_name:
        st.warning("‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞")
    else:
        with st.spinner("ü§ñ AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏±‡πà‡∏ô‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢... ‡∏£‡∏≠‡πÅ‡∏õ‡πä‡∏ö..."):
            result = generate_script(product_name, features, tone_select)
            st.success("‡πÄ‡∏™‡∏£‡πá‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢! ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢")
            st.markdown("---")
            st.markdown(result) # ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà AI ‡∏ï‡∏≠‡∏ö‡∏°‡∏≤
            
            # ‡∏õ‡∏∏‡πà‡∏° Copy (Streamlit ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÜ ‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° copy ‡πÉ‡∏ô code block ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ logic ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ)streamlit run app.py
